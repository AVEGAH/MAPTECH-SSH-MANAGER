#!/bin/bash
# ANSI color codes
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[0;33m'
BLUE='\033[0;34m'
BOLD='\033[1m'
NC='\033[0m' # No Color

# Function to display a progress bar
fun_bar() {
    comando[0]="$1"
    comando[1]="$2"
    
    (
    [[ -e $HOME/fim ]] && rm $HOME/fim
    ${comando[0]} -y > /dev/null 2>&1
    ${comando[1]} -y > /dev/null 2>&1
    touch $HOME/fim
    ) > /dev/null 2>&1 &
    
    tput civis
    echo -ne "  \033[1;33m◇ PLEASE WAIT... \033[1;37m- \033[1;33m["
    while true; do
        for ((i=0; i<18; i++)); do
            echo -ne "\033[1;31m#"
            sleep 0.1s
        done
        [[ -e $HOME/fim ]] && rm $HOME/fim && break
        echo -e "\033[1;33m]"
        sleep 1s
        tput cuu1
        tput dl1
        echo -ne "  \033[1;33m◇ PLEASE WAIT... \033[1;37m- \033[1;33m["
    done
    echo -e "\033[1;33m]\033[1;37m -\033[1;32m◇ DONE!\033[1;37m"
    tput cnorm
}

# Function to verify key
verif_key() {
    krm=$(echo '5:q-3gs2.o7%8:1'|rev)
    chmod +x $_Ink/list > /dev/null 2>&1
    [[ ! -e "$_Ink/list" ]] && {
        echo -e "\n\033[1;31m◇ KEY INVALID!\033[0m"
        rm -rf $HOME/hehe > /dev/null 2>&1
        sleep 2
        clear
        exit 1
    }
}

# Function to generate a random password based on the username
generate_password() {
    local username="$1"
    local password=$(openssl rand -base64 12)  # Generate a random password
    echo "$username:$password"  # Print username:password
}

# Function to send a message to Telegram
send_telegram_message() {
    local message="$1"
    local telegram_handle="$2"
    
    # Replace YOUR_BOT_TOKEN and YOUR_CHAT_ID with your actual bot token and chat ID
    local bot_token="6803390472:AAEEX8hpTFhsxbmzU5oiZD4dYCOKxS4-lCE"
    local chat_id="5989863155"
    
    # Send message to Telegram
    curl -s -X POST "https://api.telegram.org/bot$bot_token/sendMessage" -d "chat_id=$chat_id" -d "text=$message" > /dev/null
}

clear

# Check for root privilege
[[ "$(whoami)" != "root" ]] && {
    echo -e "\033[1;33m[\033[1;31mErro\033[1;33m] \033[1;37m- \033[1;33m◇ YOU NEED TO RUN AS ROOT!\033[0m"
    rm $HOME/hehe > /dev/null 2>&1
    exit 0
}

send_code_telegram

# Prompt the user to enter the verification code
msg -bar2
figlet " -MAPTECHGH- " | lolcat
echo "Contact @maptechgh on telegram for verification."
echo  # Add a newline for spacing

echo -n "Enter the verification code: " 
read user_code 

# Compare the entered code with the generated code
if [[ "$user_code" != "$random_code" ]]; then
    echo "Invalid code. Installation aborted."
    exit 1
fi

# Prompt the user to enter their username
echo -n "Enter your username: "
read username

# Generate a password based on the username
password=$(generate_password "$username")

# Send the generated password to Telegram
send_telegram_message "Your generated password is: $password" "@YourTelegramHandle"

echo "Password has been sent to your Telegram."
